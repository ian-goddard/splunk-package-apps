[digital_identity_audit_analysis_event_payload]
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)
NO_BINARY_CHECK=true
TIME_FORMAT=%Y-%m-%dT%H:%M:%S.%3N%Z
TIME_PREFIX="timestamp_formatted":"
MAX_TIMESTAMP_LOOKAHEAD=24
INDEXED_EXTRACTIONS = JSON
KV_MODE = NONE
AUTO_KV_JSON = false
BREAK_ONLY_BEFORE = {"event_id":

[alphavgov_github_security]
DATETIME_CONFIG=CURRENT
SHOULD_LINEMERGE=false
LINE_BREAKER=([\r\n]+)
NO_BINARY_CHECK=true
BREAK_ONLY_BEFORE={"isArchived":
CHARSET=UTF-8
disabled=false
TRUNCATE =30000

### CUSTOM AWS SOURCETYPES ###

[aws:cloudwatchlogs:codebuild]
LINE_BREAKER = (\[Container\])
SHOULD_LINEMERGE = false
NO_BINARY_CHECK = true

[aws:cloudwatchlogs:step-function]
LINE_BREAKER = (\[Container\])
SHOULD_LINEMERGE = false
NO_BINARY_CHECK = true
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS Owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou


[aws:cloudwatchlogs:states]
LINE_BREAKER = (\[Container\])
SHOULD_LINEMERGE = false
NO_BINARY_CHECK = true
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS Owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou


[aws:cloudwatchlogs:rds]
LINE_BREAKER = (\[Container\])
SHOULD_LINEMERGE = false
NO_BINARY_CHECK = true
EXTRACT-query = LOG:\s(?<query>.*)
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou


[aws:cloudwatchlogs:lambda]
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = true
NO_BINARY_CHECK = true
EXTRACT-billed_duration = Billed\sDuration:\s(?<billed_duration>\d+)\s
EXTRACT-duration = Duration:\s(?<duration>\d+.\d+)\s
EXTRACT-max_memory_used = Max\sMemory\sUsed:\s(?<max_memory_used>\d+)\s
EXTRACT-memory_size = Memory\sSize:\s(?<memory_size>\d+)\s
EXTRACT-requestId = RequestId:\s(?<requestId>[a-zA-Z0-9-]+)\s
EXTRACT-version = Version:\s(?<Version>.*?)\s
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou

[aws:cloudwatchlogs:dnsresolver]
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = true
NO_BINARY_CHECK = true
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS Owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou

[aws:cloudwatchlogs:dns]
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = true
NO_BINARY_CHECK = true
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS Owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou


[aws:cloudwatchlogs:api-gateway]
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = true
NO_BINARY_CHECK = true
EXTRACT-ua_product,ua_device,ua_os,ua_rest = \"userAgent\":\"(?P<ua_product>One( )?Login\/[0-9\.]+) (?P<ua_device>[A-Za-z0-9\/\.,\- ]+) (?P<ua_os>(Android|iOS)\/[0-9\.]+) (?P<ua_rest>[A-Za-z0-9\.\/ ]+)\"
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou

[aws:cloudwatchlogs:api-access-logs]
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = true
NO_BINARY_CHECK = true
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS owner OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou


### SPLUNK SUPPORTED AWS SOURCETYPES ###

[aws:cloudtrail]
LOOKUP-account-mapping = POD-Mapping "AWS ID" AS recipientAccountId OUTPUTNEW POD AS pod Team AS team
EXTRACT-RequestedRole = "AWSReservedSSO_(?<RequestedRole>[^_]+)_
EXTRACT-Role = AWSReservedSSO_(?<Role>[^_]+)_
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS recipientAccountId OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou "Service Level" AS service_level
EXTRACT-arn = ^(?:[^,\n]*,){3}(?P<arn>[^:]+)

[aws:cloudwatchlogs:vpcflow]
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS account_id OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou
EXTRACT-tcp_flag = ^(.*?\s+){14}(?<tcp_flag>[\d-]+)
LOOKUP-tcp_flag = tcp_flag_vpc tcp_flag AS tcp_flag OUTPUTNEW tcp_flag_message AS tcp_flag_message
REPORT-VPCFlow = REPORT-VPCFlow
LOOKUP-AWS-TrafficFlow = AWS-TrafficFlow "traffic-path" AS traffic_path OUTPUTNEW "traffic-path-description" AS traffic_path_description

[aws:securityhub:finding]
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS "detail.findings{}.AwsAccountId" OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou
LOOKUP-aws-pod-mapping = POD-Mapping "AWS ID" AS "detail.findings{}.AwsAccountId" OUTPUTNEW POD AS pod Team AS team
LOOKUP-aws-conformance-mapping = Conformance-Pack RULENAME AS config_rule_base OUTPUTNEW PACKNAME AS conformance_pack
EVAL-config_rule_base = replace('detail.findings{}.ProductFields.aws/config/ConfigRuleName', "-conformance-pack.*", "")

[aws:waf]
LOOKUP-aws-account-mapping = Account-Mapping "Account ID" AS AccountId OUTPUTNEW "Account Name" AS di_account_name_enriched "Residing OU" AS residing_ou
EVAL-AccountId = replace(webaclId, ".*:([^:]+):.*", "\1")
LOOKUP-POD-mapping-waf = POD-Mapping "AWS ID" AS AccountId OUTPUTNEW POD AS pod Team AS team
EVAL-webaclName = replace(webaclId, "^.*webacl/([^/]+)/.*$", "\1")